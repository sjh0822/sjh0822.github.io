<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" >

<title>测试 | Gridea</title>

<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">

<link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.7.2/css/all.css" integrity="sha384-fnmOCqbTlWIlj8LyTjo7mOUStjsKC4pOpQbqyi7RrhN7udi9RwhKkMHpvLbHG9Sr" crossorigin="anonymous">
<link rel="shortcut icon" href="https://sjh0822.github.io/favicon.ico?v=1614585946865">
<link rel="stylesheet" href="https://sjh0822.github.io/styles/main.css">



<link rel="stylesheet" href="https://unpkg.com/aos@next/dist/aos.css" />
<script src="https://cdn.jsdelivr.net/npm/vue/dist/vue.js"></script>



    <meta name="description" content="Mybatis框架应用
[TOC]


先导入Mybatis需要的jar包 或者使用 maven 工程导入下面的依赖


&lt;dependencies&gt;
       &lt;!--mybatis的依赖--&gt;
       ..." />
    <meta name="keywords" content="" />
  </head>
  <body>
    <div id="app" class="main">

      <div class="sidebar" :class="{ 'full-height': menuVisible }">
  <div class="top-container" data-aos="fade-right">
    <div class="top-header-container">
      <a class="site-title-container" href="https://sjh0822.github.io">
        <img src="https://sjh0822.github.io/images/avatar.png?v=1614585946865" class="site-logo">
        <h1 class="site-title">Gridea</h1>
      </a>
      <div class="menu-btn" @click="menuVisible = !menuVisible">
        <div class="line"></div>
      </div>
    </div>
    <div>
      
        
          <a href="/" class="site-nav">
            首页
          </a>
        
      
        
          <a href="/archives" class="site-nav">
            归档
          </a>
        
      
        
          <a href="/tags" class="site-nav">
            标签
          </a>
        
      
        
          <a href="/post/about" class="site-nav">
            关于
          </a>
        
      
    </div>
  </div>
  <div class="bottom-container" data-aos="flip-up" data-aos-offset="0">
    <div class="social-container">
      
        
      
        
      
        
      
        
      
        
      
    </div>
    <div class="site-description">
      温故而知新
    </div>
    <div class="site-footer">
      Powered by <a href="https://github.com/getgridea/gridea" target="_blank">Gridea</a> | <a class="rss" href="https://sjh0822.github.io/atom.xml" target="_blank">RSS</a>
    </div>
  </div>
</div>


      <div class="main-container">
        <div class="content-container" data-aos="fade-up">
          <div class="post-detail">
            <h2 class="post-title">测试</h2>
            <div class="post-date">2021-03-01</div>
            
            <div class="post-content" v-pre>
              <h1 id="mybatis框架应用">Mybatis框架应用</h1>
<p>[TOC]</p>
<ul>
<li>
<p>先导入Mybatis需要的jar包 或者使用 maven 工程导入下面的依赖</p>
</li>
<li>
<pre><code class="language-java">&lt;dependencies&gt;
       &lt;!--mybatis的依赖--&gt;
       &lt;dependency&gt;
           &lt;groupId&gt;org.mybatis&lt;/groupId&gt;
           &lt;artifactId&gt;mybatis&lt;/artifactId&gt;
           &lt;version&gt;3.4.6&lt;/version&gt;
       &lt;/dependency&gt;
       &lt;!--msql数据库依赖--&gt;
       &lt;dependency&gt;
           &lt;groupId&gt;mysql&lt;/groupId&gt;
           &lt;artifactId&gt;mysql-connector-java&lt;/artifactId&gt;
           &lt;version&gt;5.1.47&lt;/version&gt;
       &lt;/dependency&gt;
       &lt;!--单元测试--&gt;
       &lt;dependency&gt;
           &lt;groupId&gt;junit&lt;/groupId&gt;
           &lt;artifactId&gt;junit&lt;/artifactId&gt;
           &lt;version&gt;4.0&lt;/version&gt;
           &lt;scope&gt;test&lt;/scope&gt;
       &lt;/dependency&gt;
   &lt;/dependencies&gt;
   &lt;!--扫描.xml文件和.properties属性文件--&gt;
   &lt;build&gt;
       &lt;resources&gt;
            &lt;resource&gt;
                 &lt;directory&gt;src/main/resources&lt;/directory&gt;
                &lt;includes&gt;
                    &lt;include&gt;**/*.properties&lt;/include&gt;
                    &lt;include&gt;**/*.xml&lt;/include&gt;
                &lt;/includes&gt;
                &lt;filtering&gt;true&lt;/filtering&gt;
            &lt;/resource&gt;
           &lt;resource&gt;
               &lt;directory&gt;src/main/java&lt;/directory&gt;
               &lt;includes&gt;
                   &lt;include&gt;**/*.properties&lt;/include&gt;
                   &lt;include&gt;**/*.xml&lt;/include&gt;
               &lt;/includes&gt;
               &lt;filtering&gt;true&lt;/filtering&gt;
           &lt;/resource&gt;
       &lt;/resources&gt;
   &lt;/build&gt;
</code></pre>
</li>
</ul>
<h2 id="第一步">第一步</h2>
<ul>
<li>
<p>​		编写mybaitis的xml文件</p>
</li>
<li>
<pre><code class="language-java">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF8&quot; ?&gt;
&lt;!DOCTYPE configuration
        PUBLIC &quot;-//mybatis.org//DTD Config 3.0//EN&quot;
        &quot;http://mybatis.org/dtd/mybatis-3-config.dtd&quot;&gt;
&lt;configuration&gt;
    &lt;properties resource=&quot;Db.properties&quot;/&gt;
    &lt;environments default=&quot;default&quot;&gt;
        &lt;environment id=&quot;default&quot;&gt;
            &lt;transactionManager type=&quot;JDBC&quot;&gt;&lt;/transactionManager&gt;
            &lt;dataSource type=&quot;POOLED&quot;&gt;
                &lt;property name=&quot;driver&quot; value=&quot;${driver}&quot;/&gt;
                &lt;property name=&quot;url&quot; value=&quot;${url}&quot;/&gt;
                &lt;property name=&quot;username&quot; value=&quot;${username}&quot;/&gt;
                &lt;property name=&quot;password&quot; value=&quot;${password}&quot;/&gt;
            &lt;/dataSource&gt;
        &lt;/environment&gt;
    &lt;/environments&gt;
    &lt;!--扫描器用于扫描与接口绑定的xml文件--&gt;
    &lt;mappers&gt;
        &lt;mapper resource=&quot;com/shengjiahao/dao/UserMapper.xml&quot;/&gt;
    &lt;/mappers&gt;

</code></pre>
</li>
</ul>
<h2 id="第二步">第二步</h2>
<ul>
<li>
<p>​     编写实体类</p>
</li>
<li>
<pre><code class="language-java">package com.shengjiahao.pojo;

public class User {
      private  int uid;
      private  String uname;
      private  String upwd;

        public User() {
        }



    public User(int uid, String uname, String upwd) {
        this.uid = uid;
        this.uname = uname;
        this.upwd = upwd;
    }

    public int getUid() {
        return uid;
    }

    public void setUid(int uid) {
        this.uid = uid;
    }

    public String getUname() {
        return uname;
    }

    public void setUname(String uname) {
        this.uname = uname;
    }

    public String getUpwd() {
        return upwd;
    }

    public void setUpwd(String upwd) {
        this.upwd = upwd;
    }

    @Override
    public String toString() {
        return &quot;User{&quot; +
                &quot;uid=&quot; + uid +
                &quot;, uname='&quot; + uname + '\'' +
                &quot;, upwd='&quot; + upwd + '\'' +
                '}';
    }
}
</code></pre>
<h2 id="第三步-自定义sqlsession-工具类-获取sqlsession对象">第三步 自定义Sqlsession 工具类 获取Sqlsession对象<img src="" alt="" loading="lazy"></h2>
</li>
</ul>
<pre><code class="language-java"> * SqlSession 工具类
 */
public class MybatisUtil {

    private static SqlSessionFactory sqlSessionFactory;
    //当类启动时加载这段代码
    static {
        try {
            String resource= &quot;Mybatis.xml&quot;;
            InputStream  inputStream = Resources.getResourceAsStream(resource);
            sqlSessionFactory = new SqlSessionFactoryBuilder().build(inputStream);
        } catch (IOException e) {
            e.printStackTrace();
        }
    }
	
    public static SqlSession getsqlsession()
    {
        return sqlSessionFactory.openSession();
    }
}

</code></pre>
<h2 id="第四步-使用接口绑定">第四步 使用接口绑定</h2>
<ul>
<li>
<p>创建的 接口名 与 实现的.xml 文件名一致 并且使其在同一个包下</p>
</li>
<li>
<p>其中xml中 mapper 标签中的 namespace属性指向接口的全路径</p>
</li>
<li>
<p>注意点</p>
<ul>
<li>接口的方法名与mapper文件里的标签id相同</li>
<li>参数与parameterType的参数相同</li>
<li>返回值接口的返回值相同</li>
</ul>
</li>
<li>
<p>接口实现</p>
</li>
<li>
<pre><code class="language-java">import com.shengjiahao.pojo.User;

import java.util.List;

public interface UserMapper {
    /***
     * 查全部
     */
     List&lt;User&gt; selectAll();
    /**
     * 删除
     */
    int deleteById(int uid);

    /**
     * 查看个人
     */
     User selectById(int uid);
    /**
     * 修改
     */
     int updateById(User user);
    /***
     * 新增
     */
     int AddUser(User user);
}
</code></pre>
</li>
<li>
<p>mapper.xml文件实现</p>
</li>
<li>
<pre><code>&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF8&quot; ?&gt;
&lt;!DOCTYPE mapper
        PUBLIC &quot;-//mybatis.org//DTD Mapper 3.0//EN&quot;
        &quot;http://mybatis.org/dtd/mybatis-3-mapper.dtd&quot;&gt;
&lt;mapper namespace=&quot;com.shengjiahao.dao.UserMapper&quot;&gt;

     &lt;!--查询全部--&gt;
     &lt;select id=&quot;selectAll&quot; resultType=&quot;com.shengjiahao.pojo.User&quot;&gt;
         select * from mvc.user
     &lt;/select&gt;
    &lt;!--新增--&gt;
     &lt;insert id=&quot;AddUser&quot;  parameterType=&quot;com.shengjiahao.pojo.User&quot;&gt;
         insert into mvc.user values(null,#{uname},#{upwd})
     &lt;/insert&gt;
    &lt;!--删除--&gt;
     &lt;delete id=&quot;deleteById&quot; parameterType=&quot;int&quot;&gt;
          delete  from USER where uid=#{uid}
     &lt;/delete&gt;

    &lt;!--修改--&gt;
    &lt;update id=&quot;updateById&quot;  parameterType=&quot;com.shengjiahao.pojo.User&quot; &gt;
          update User set uname=#{uname},upwd=#{upwd} where uid=#{uid}
    &lt;/update&gt;

    &lt;select id=&quot;selectById&quot; resultType=&quot;com.shengjiahao.pojo.User&quot; parameterType=&quot;int&quot;&gt;
         select * from USER  where uid=#{uid}
    &lt;/select&gt;


</code></pre>
<h2 id="第五步-测试">第五步 测试</h2>
</li>
<li>
<p>使用自定义的Sqlsession工具累获取 Sqlsession对象</p>
</li>
<li>
<p>在调用 Sqlsession下的getMapper()方法  参数是 接口的的反射.class</p>
</li>
<li>
<p>注意点 mybatis.xml 的数据提交时JDBC 在测试的时候需要手动提交  sqlsession.commit();</p>
</li>
<li>
<pre><code class="language-java">package com.shengjia.test;

import com.shengjiahao.Util.MybatisUtil;
import com.shengjiahao.dao.UserMapper;
import com.shengjiahao.pojo.User;
import org.apache.ibatis.io.Resources;
import org.apache.ibatis.session.SqlSession;
import org.apache.ibatis.session.SqlSessionFactory;
import org.apache.ibatis.session.SqlSessionFactoryBuilder;

import java.io.IOException;
import java.io.InputStream;
import java.util.List;

public class Test {
    public static void main(String[] args) {
        SqlSession sqlsession = MybatisUtil.getsqlsession();
        UserMapper mapper = sqlsession.getMapper(UserMapper.class);

        User user = new User(4,&quot;张三&quot;,&quot;zs&quot;);
        int i = mapper.updateById(user);
        System.out.println(i);
        sqlsession.commit();

    }
}
</code></pre>
</li>
</ul>
<h2 id="配置mybatisxml文件属性">配置Mybatis.xml文件属性</h2>
<ol>
<li>
<p>外部引入.properties配置文件</p>
</li>
<li>
<pre><code class="language-java">&lt;properties resource=&quot;Db.properties&quot;/&gt;

也可以内部自定义属性

&lt;properties&gt;
        &lt;property name=&quot;username&quot; value=&quot;root&quot;/&gt;
        &lt;property name=&quot;password&quot; value=&quot;123&quot;/&gt;
&lt;/properties&gt;
</code></pre>
</li>
</ol>
<p>​     编写 .properties 文件</p>
<pre><code class="language-java">driver=com.mysql.jdbc.Driver
url=jdbc:mysql://localhost:3306/mvc?useSSL=true&amp;amp;useUnicode=true&amp;amp;charsetEncoding=UTF-8
username=root
password=123
</code></pre>
<p>在 mybatis.xml 中引用文件内的属性</p>
<pre><code class="language-java">&lt;configuration&gt;
    &lt;properties resource=&quot;Db.properties&quot;/&gt;
    &lt;environments default=&quot;default&quot;&gt;
        &lt;environment id=&quot;default&quot;&gt;
            &lt;transactionManager type=&quot;JDBC&quot;&gt;&lt;/transactionManager&gt;
            &lt;dataSource type=&quot;POOLED&quot;&gt;
                &lt;property name=&quot;driver&quot; value=&quot;${driver}&quot;/&gt;
                &lt;property name=&quot;url&quot; value=&quot;${url}&quot;/&gt;
                &lt;property name=&quot;username&quot; value=&quot;${username}&quot;/&gt;
                &lt;property name=&quot;password&quot; value=&quot;${password}&quot;/&gt;
            &lt;/dataSource&gt;
        &lt;/environment&gt;
    &lt;/environments&gt;
    &lt;mappers&gt;
        &lt;mapper resource=&quot;com/shengjiahao/dao/UserMapper.xml&quot;/&gt;
    &lt;/mappers&gt;
&lt;/configuration&gt;
</code></pre>
<h3 id="1别名typealiases">1.(别名)typeAliases</h3>
<p>类型别名是为 Java 类型命名一个短的名字。它只和 XML 配置有关, 只用来减少类完全限定名的多余部分。</p>
<p>type:指定需要生成别名的实体类</p>
<p>alias：该类生成的别名</p>
<pre><code class="language-java">&lt;typeAliases&gt;
  &lt;typeAlias alias=&quot;Author&quot; type=&quot;domain.blog.Author&quot;/&gt;
  &lt;typeAlias alias=&quot;Blog&quot; type=&quot;domain.blog.Blog&quot;/&gt;
  &lt;typeAlias alias=&quot;Comment&quot; type=&quot;domain.blog.Comment&quot;/&gt;
  &lt;typeAlias alias=&quot;Post&quot; type=&quot;domain.blog.Post&quot;/&gt;
  &lt;typeAlias alias=&quot;Section&quot; type=&quot;domain.blog.Section&quot;/&gt;
  &lt;typeAlias alias=&quot;Tag&quot; type=&quot;domain.blog.Tag&quot;/&gt;
&lt;/typeAliases&gt;
</code></pre>
<p>自动扫描 实体类 并默认生成 类的别名</p>
<p>package:指定需要扫描实体类包的所在位置</p>
<pre><code class="language-java">&lt;typeAliases&gt;
  &lt;package name=&quot;domain.blog&quot;/&gt;
&lt;/typeAliases&gt;
</code></pre>
<h3 id="2映射器mapper">2.映射器(Mapper)</h3>
<p><strong>方式一 使用 mapper.xml 文件绑定方式 resource=“.xml文件路径”</strong></p>
<pre><code class="language-java">&lt;mappers&gt;
        &lt;mapper resource=&quot;com/shengjiahao/dao/UserMapper.xml&quot;/&gt;
&lt;/mappers&gt;
</code></pre>
<p><strong>方式二  使用直接绑定接口的方式   class=”指定接口文件的路径“</strong></p>
<pre><code class="language-xml">&lt;mappers&gt;
        &lt;mapper class=&quot;com.shengjiahao.dao.UserMapper&quot;/&gt;
&lt;/mappers&gt;
</code></pre>
<p><strong>方式三</strong>  <strong>使用 package 属性</strong> <strong>扫描整个文件</strong></p>
<pre><code class="language-.xml">  &lt;mappers&gt;
          &lt;package name=&quot;com.shengjiahao.dao&quot;/&gt;
  &lt;/mappers&gt;
</code></pre>
<h2 id="结果集映射resultmap">结果集映射（resultMap）</h2>
<ul>
<li>
<p>主要解决 实体类字段名和数据库的列名不一致时</p>
</li>
<li>
<pre><code class="language-java">实体类字段  id uname password
数据库对应列 id uname upwd
</code></pre>
<p><strong>resultMap</strong></p>
<pre><code class="language-xml">&lt;select id=&quot;selectAll&quot; resultMap=&quot;UserMap&quot;&gt;
         select * from mvc.user
&lt;/select&gt;
     &lt;resultMap id=&quot;UserMap&quot; type=&quot;user&quot;&gt;
          &lt;id property=&quot;id&quot; column=&quot;id&quot;&gt;&lt;/id&gt;
          &lt;result property=&quot;uname&quot; column=&quot;uname&quot;&gt;&lt;/result&gt;
          &lt;result property=&quot;password&quot; column=&quot;upwd&quot;&gt;&lt;/result&gt;
     &lt;/resultMap&gt;
</code></pre>
</li>
</ul>
<p>​       数据库查询标签的  <strong>resultMap的值</strong>  指向  **resultMap标签中的id **</p>
<p>​       <strong>type</strong>属性即为返回类型   <strong>property:实体类属性的名字</strong>   <strong>column 数据库对应的列</strong></p>
<p>​</p>
<h2 id="日志-实现-settings">日志 实现 （settings）</h2>
<ul>
<li>
<p>mybaitis标准的日志实现</p>
</li>
<li>
<pre><code class="language-xml">&lt;settings&gt;
       &lt;setting name=&quot;logImpl&quot; value=&quot;STDOUT_LOGGING&quot;/&gt;
   &lt;/settings&gt;
</code></pre>
</li>
<li>
<figure data-type="image" tabindex="1"><img src="C:%5CUsers%5C18472%5CDesktop%5Ctempsnip.png" alt="tempsnip" loading="lazy"></figure>
</li>
</ul>
<h3 id="log4g">LOG4G</h3>
<ul>
<li>
<p><strong>settings属性的配置</strong></p>
</li>
<li>
<pre><code class="language-xml">&lt;settings&gt;
       &lt;setting name=&quot;logImpl&quot; value=&quot;LOG4J&quot;/&gt;
 &lt;/settings&gt;
</code></pre>
</li>
<li></li>
<li>
<p>​	<strong>导入 log4j 的jar包</strong></p>
<pre><code class="language-xml">&lt;dependency&gt;
            &lt;groupId&gt;log4j&lt;/groupId&gt;
            &lt;artifactId&gt;log4j&lt;/artifactId&gt;
            &lt;version&gt;1.2.17&lt;/version&gt;
&lt;/dependency&gt;
</code></pre>
</li>
<li>
<p><strong>编写 log4j.properties文件</strong></p>
</li>
<li>
<pre><code class="language-html">log4j.rootLogger=DEBUG, stdout
log4j.appender.stdout=org.apache.log4j.ConsoleAppender
log4j.appender.stdout.layout=org.apache.log4j.PatternLayout
log4j.appender.stdout.layout.ConversionPattern=%C %m %L %n
</code></pre>
</li>
<li></li>
</ul>
<h2 id="myabtis分页">Myabtis分页</h2>
<ul>
<li>
<pre><code class="language-xml">&lt;select id=&quot;selectLImit&quot; resultMap=&quot;UserMap&quot;  parameterType=&quot;map&quot;&gt;
         select * from mvc.user  limit #{startIndex},#{PageSize}
    &lt;/select&gt;
</code></pre>
</li>
<li>
<p>测试</p>
</li>
<li>
<pre><code class="language-java">ublic class Test {
    public static void main(String[] args) {
        SqlSession sqlsession = MybatisUtil.getSqlsession();
        UserMapper mapper = sqlsession.getMapper(UserMapper.class);
        Map&lt;String,Integer&gt; map = new HashMap&lt;String, Integer&gt;();
        map.put(&quot;startIndex&quot;,1);
        map.put(&quot;PageSize&quot;,2);
        List&lt;User&gt; users = mapper.selectLImit(map);
        for (User user : users) {
            System.out.println(user);
        }


    }
}
</code></pre>
</li>
</ul>
<h2 id="crud-annotation">CRUD Annotation</h2>
<p>​		<strong>代码</strong></p>
<pre><code class="language-java"> /***
     * 查全部
     */
     @Select(&quot;select * from User&quot;)
     List&lt;User&gt; selectAll();
    /**
     * 删除
     */
    @Delete(&quot;delete from User where uid=#{uid}&quot;)
    int deleteById(int uid);

    /**
     * 查看个人
     */
     @Select(&quot;select * from User where uid=#{uid}&quot;)
     User selectById(int uid);
    /**
     * 修改
     */
     @Update(&quot;update user set uname=#{uname},upwd=#{upwd} where uid=#{uid}&quot;)
     int updateById(User user);
    /***
     * 新增
     */
     @Insert(&quot;insert into user values(null,#{uname},#{upwd})&quot;)
     int AddUser(User user);
</code></pre>
<h2 id="多对一-案例多个学生对应一个老师">多对一 案例（多个学生对应一个老师）</h2>
<h3 id="数据库代码">数据库代码</h3>
<pre><code class="language-sql">CREATE TABLE Student(
	sid INT PRIMARY KEY AUTO_INCREMENT,
	sname NVARCHAR(20),
	tid INT

)
CREATE TABLE teacher(
	tid INT PRIMARY KEY AUTO_INCREMENT,
	tname NVARCHAR(20)
)
INSERT INTO Student VALUES(NULL,'盛佳豪',1);
INSERT INTO Student VALUES(NULL,'杨克',2);
INSERT INTO Student VALUES(NULL,'周豪',1);
INSERT INTO Student VALUES(NULL,'汪涵',2);

INSERT INTO teacher VALUES(NULL,'秦老师');
INSERT INTO teacher VALUES(NULL,'王老师');
</code></pre>
<h3 id="代码mapper嵌套式查询">.代码Mapper（嵌套式查询）</h3>
<pre><code class="language-xml"> //使用resultMap进行结果映射
        &lt;select id=&quot;getStudentList&quot; resultMap=&quot;StudentAndTeacher&quot;&gt;
             select * from student
        &lt;/select&gt;
        &lt;resultMap id=&quot;StudentAndTeacher&quot; type=&quot;Student&quot;&gt;
               &lt;result property=&quot;sid&quot; column=&quot;sid&quot;&gt;&lt;/result&gt;
               &lt;result property=&quot;sname&quot; column=&quot;sname&quot;&gt;&lt;/result&gt;
                //对象类型使用association 实体类字段名 property  column对应数据的列 javaType指定类型 select 引用嵌套的查询语句
               &lt;association property=&quot;teacher&quot; column=&quot;tid&quot; javaType=&quot;Teacher&quot; select=&quot;getTeacher&quot;/&gt;
        &lt;/resultMap&gt;

        &lt;select id=&quot;getTeacher&quot; resultType=&quot;Teacher&quot;&gt;
             select * from teacher where tid=#{tid}
        &lt;/select&gt;
</code></pre>
<h3 id="代码2mapper包含式查询">代码2Mapper（包含式查询）</h3>
<pre><code class="language-xml">&lt;select id=&quot;getStudentList&quot; resultMap=&quot;StudentAndTeacher&quot;&gt;
             select * from student s inner join teacher t on t.tid = s.tid
        &lt;/select&gt;
        &lt;resultMap id=&quot;StudentAndTeacher&quot; type=&quot;Student&quot;&gt;
                &lt;result property=&quot;sid&quot; column=&quot;sid&quot;&gt;&lt;/result&gt;
                &lt;result property=&quot;sname&quot; column=&quot;sname&quot;&gt;&lt;/result&gt;
                 //属性是对象类型
                &lt;association property=&quot;teacher&quot; javaType=&quot;Teacher&quot;&gt;
                        &lt;result property=&quot;tid&quot; column=&quot;tid&quot;&gt;&lt;/result&gt;
                        &lt;result property=&quot;tname&quot; column=&quot;tname&quot;&gt;&lt;/result&gt;
                &lt;/association&gt;
        &lt;/resultMap&gt;
</code></pre>
<h2 id="一对多一个老师包含多个学生">一对多（一个老师包含多个学生）</h2>
<h3 id="实体类">实体类</h3>
<pre><code class="language-java">public class Teacher {
     private  int tid;
     private String tname;
     private List&lt;Student&gt; students;
}

</code></pre>
<pre><code class="language-java">public class Student {
     private  int sid;
     private  String sname;
     private  int tid;
}

</code></pre>
<h3 id="包含式查询-集合类型使用collection">包含式查询 集合类型使用（collection）</h3>
<pre><code class="language-java"> &lt;!--指定一个老师查出所有包含的学生-包含式查询
 &lt;select id=&quot;getTeacherList&quot; resultMap=&quot;TeacherAndStudnt&quot; parameterType=&quot;_int&quot;&gt;
     select * from teacher t inner join student s on t.tid = s.tid
 &lt;/select&gt;

&lt;resultMap id=&quot;TeacherAndStudnt&quot; type=&quot;Teacher&quot;&gt;
        &lt;result property=&quot;tid&quot; column=&quot;tid&quot;&gt;&lt;/result&gt;
        &lt;result property=&quot;tname&quot; column=&quot;tname&quot;&gt;&lt;/result&gt;
		//ofType 指定该类型的泛型类型
        &lt;collection property=&quot;students&quot; ofType=&quot;Student&quot;&gt;
                &lt;result property=&quot;sid&quot; column=&quot;sid&quot;&gt;&lt;/result&gt;
                &lt;result property=&quot;sname&quot; column=&quot;sname&quot;&gt;&lt;/result&gt;
                &lt;result property=&quot;tid&quot; column=&quot;tid&quot;&gt;&lt;/result&gt;
        &lt;/collection&gt;
&lt;/resultMap&gt;
</code></pre>
<h3 id="嵌套式查询">嵌套式查询</h3>
<pre><code class="language-xml"> &lt;!--嵌套子查询--&gt;
       &lt;select id=&quot;getTeacherList2&quot; resultMap=&quot;TeacherAndStudnt&quot;&gt;
             select * from teacher where tid=#{tid}
       &lt;/select&gt;
       &lt;resultMap id=&quot;TeacherAndStudnt&quot; type=&quot;Teacher&quot;&gt;
             &lt;result property=&quot;tid&quot; column=&quot;tid&quot;&gt;&lt;/result&gt;
             &lt;result property=&quot;tname&quot; column=&quot;tname&quot;&gt;&lt;/result&gt;
              //
             &lt;collection property=&quot;students&quot; javaType=&quot;ArrayList&quot; ofType=&quot;Student&quot; 			select=&quot;getStudent&quot; column=&quot;tid&quot;/&gt;
       &lt;/resultMap&gt;
       &lt;select id=&quot;getStudent&quot; resultType=&quot;Student&quot;&gt;
            select * from student where tid =#{tid}
       &lt;/select&gt;
</code></pre>
<h3 id=""></h3>
<p>总结</p>
<ul>
<li>
<p>属性是对象类型<strong>association</strong>   属性是集合类型<strong>collection</strong></p>
</li>
<li>
<p>JavaType值得是Java的类型 &amp;&amp; oftype只得是list或集合中的泛型</p>
</li>
</ul>
<h2 id="动态sql-标签">动态Sql 标签</h2>
<h3 id="if标签">if标签</h3>
<ul>
<li>注意sql 语句的拼接 where 1=1</li>
</ul>
<pre><code class="language-xml"> &lt;select id=&quot;selectSexAndDname&quot; resultType=&quot;Emps&quot; parameterType=&quot;map&quot;&gt;
             select * from emps where 1=1
             &lt;if test=&quot;sex !=null&quot;&gt;
                 and sex=#{sex}
             &lt;/if&gt;
             &lt;if test=&quot;dname!=null&quot;&gt;
                and dname=#{dname}
             &lt;/if&gt;
        &lt;/select&gt;
</code></pre>
<h3 id="where标签-与if-标签-配合使用">where标签 与if 标签 配合使用</h3>
<ul>
<li>会自动解析掉第一个条件的 and 关键字</li>
</ul>
<pre><code class="language-xml">  &lt;select id=&quot;selectSexAndDname&quot; resultType=&quot;Emps&quot; parameterType=&quot;map&quot;&gt;
             select * from emps
             &lt;where&gt;
             &lt;if test=&quot;sex !=null&quot;&gt;
                 and sex=#{sex}
             &lt;/if&gt;
             &lt;if test=&quot;dname!=null&quot;&gt;
                and dname=#{dname}
             &lt;/if&gt;
             &lt;/where&gt;
        &lt;/select&gt;

</code></pre>
<h3 id="choose-when-标签-与java中-switch-相似-满足约定条件时执行">choose when 标签 与Java中 switch 相似 满足约定条件时执行</h3>
<pre><code class="language-xml"> &lt;select id=&quot;selectChoose&quot; resultType=&quot;Emps&quot; parameterType=&quot;map&quot;&gt;
             select * from emps
             &lt;where&gt;
                 &lt;choose&gt;
                     &lt;when test=&quot;sex!=null&quot;&gt;sex=#{sex}&lt;/when&gt;
                     &lt;when test=&quot;dname!=null&quot;&gt; and dname=#{dname}&lt;/when&gt;
                     &lt;otherwise&gt;
                           and 1=1;
                     &lt;/otherwise&gt;
                 &lt;/choose&gt;
             &lt;/where&gt;
        &lt;/select&gt;
</code></pre>
<h3 id="set-标签-用于修改语句-会自动解析-逗号">set 标签 用于修改语句 会自动解析 逗号</h3>
<pre><code class="language-xml">&lt;update id=&quot;UpdateEmps&quot; parameterType=&quot;map&quot;&gt;
           update emps
           &lt;set&gt;
               &lt;if test=&quot;sex!=null&quot;&gt;sex=#{sex},&lt;/if&gt;
               &lt;if test=&quot;ename!=null&quot;&gt;ename=#{ename}&lt;/if&gt;
           &lt;/set&gt;
           where  eid=#{eid}
       &lt;/update&gt;
</code></pre>
<h3 id="foreach-循环标签-批量查询">ForEach 循环标签 批量查询</h3>
<ul>
<li>
<p><strong>参数为数组</strong></p>
</li>
<li>
<pre><code class="language-xml">&lt;select id=&quot;selectArray&quot; resultType=&quot;Emps&quot; parameterType=&quot;int[]&quot;&gt;
           select * from emps
           &lt;where&gt;
               &lt;if test=&quot;array!=null and array.length&gt;0&quot;&gt;
                    &lt;foreach collection=&quot;array&quot; item=&quot;eid&quot; close=&quot;)&quot; separator=&quot;,&quot; open=&quot; eid in(&quot;&gt;
                        #{eid}
                    &lt;/foreach&gt;
               &lt;/if&gt;
           &lt;/where&gt;
       &lt;/select&gt;
</code></pre>
</li>
<li>
<p><strong>参数为集合</strong></p>
</li>
<li>
<pre><code class="language-xml">&lt;select id=&quot;selectList&quot; resultType=&quot;Emps&quot; parameterType=&quot;list&quot;&gt;
           select * from emps
           &lt;where&gt;
               &lt;if test=&quot;list!=null and list.size&gt;0&quot;&gt;
                    &lt;foreach collection=&quot;list&quot; open=&quot; eid in(&quot; separator=&quot;,&quot; close=&quot;)&quot; item=&quot;eid&quot;&gt;
                       #{eid}
                    &lt;/foreach&gt;
               &lt;/if&gt;
           &lt;/where&gt;
      &lt;/select&gt;
</code></pre>
</li>
<li></li>
</ul>

            </div>
            
            
              <div class="next-post">
                <div class="next">下一篇</div>
                <a href="https://sjh0822.github.io/post/hello-gridea/">
                  <h3 class="post-title">
                    Hello Gridea
                  </h3>
                </a>
              </div>
            

            

          </div>

        </div>
      </div>
    </div>

    <script src="https://unpkg.com/aos@next/dist/aos.js"></script>
<script type="application/javascript">

AOS.init();

var app = new Vue({
  el: '#app',
  data: {
    menuVisible: false,
  },
})

</script>






  </body>
</html>
